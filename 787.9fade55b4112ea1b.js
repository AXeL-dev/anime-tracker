"use strict";(self.webpackChunkanime_tracker=self.webpackChunkanime_tracker||[]).push([[787],{5779:(j,M,r)=>{r.d(M,{K:()=>L});var A=r(5651),m=r(1223),S=r(8798),C=r(452);let L=(()=>{class f{constructor(o,h){this.scraper=o,this.settings=h,this.crawlers=[];for(const D of A.Q7)this.add(new D(this.scraper));this.update()}update(){this.crawlers.forEach(o=>{o.isActive=-1===this.settings.inactiveCrawlers.indexOf(o.name)})}add(o){this.crawlers.push(o)}remove(o){this.crawlers=this.crawlers.filter(h=>h.name!==o.name)}get(...o){return this.crawlers.filter(h=>-1!==o.indexOf(h.name))}getAll(o=!1){return o&&this.update(),this.crawlers}getAllExcept(...o){return this.crawlers.filter(h=>-1===o.indexOf(h.name))}getActive(o=!1){return o&&this.update(),this.crawlers.filter(h=>h.isActive)}get count(){return this.getAll().length}get activeCount(){return this.getActive().length}}return f.\u0275fac=function(o){return new(o||f)(m.LFG(S.V),m.LFG(C.g))},f.\u0275prov=m.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},8798:(j,M,r)=>{r.d(M,{V:()=>V});var A=r(655),m=r(9646),S=r(1566),C=r(1165),L=r(4482),f=r(8421),g=r(3888),o=r(5403),h=r(9672);const D=(0,g.d)(u=>function(e=null){u(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e});function n(u){throw new D(u)}var i=r(4004),a=r(262),O=r(5012),R=r(3111),b=r(1223),_=r(520),U=r(4056),W=r(6622);let B=(()=>{class u{constructor(){this.parser=new DOMParser}fromString(e){return this.parser.parseFromString(e,"text/html")}parse(e,t,s,l){let p=[];const x=this.fromString(e),I=(0,W.k)(t)?t.join(", "):t;return x.querySelectorAll(I).forEach(T=>{const c={};Object.keys(s).forEach(d=>{(0,U.HD)(s[d])?c[d]=this.find(T,s[d],l):(0,W.k)(s[d])?(c[d]=[],s[d].forEach(P=>{if((0,U.HD)(P))c[d].push(this.find(T,P,l));else{let v={};Object.keys(P).forEach(y=>{v[y]=this.parseSelector(T,P[y],l)}),c[d].push(v)}})):(c[d]={},Object.keys(s[d]).forEach(P=>{c[d][P]=this.parseSelector(T,s[d][P],l)}))}),p.push(c)}),p}parseSelector(e,t,s){if(!(0,W.k)(t))return this.find(e,t,s);for(const l of t){const p=this.find(e,l,s);if(p)return p}}find(e,t,s){var l,p,x,I,T,c;const d=t.split("|"),P=d[0].split("@"),v={selector:null===(l=P[0])||void 0===l?void 0:l.trim(),attributes:null===(p=P[1])||void 0===p?void 0:p.trim().split(","),filter:null===(x=d[1])||void 0===x?void 0:x.trim()};let y=null,w="";try{(null===(I=v.selector)||void 0===I?void 0:I.length)&&(y=v.selector.startsWith(":prev ")?this.getPreviousSibling(e,v.selector.replace(":prev ","")):v.selector.startsWith(":next ")?this.getNextSibling(e,v.selector.replace(":next ","")):v.selector.startsWith(":self")?e:e.querySelector(v.selector))}catch(H){console.error(H.message)}return y&&((null===(T=v.attributes)||void 0===T?void 0:T.length)?v.attributes.forEach(H=>{(null==w?void 0:w.length)||(w=y.getAttribute(H))}):w=y.innerHTML),(null===(c=v.filter)||void 0===c?void 0:c.length)&&(null==s?void 0:s[v.filter])&&(w=s[v.filter](w,e)),w}getPreviousSibling(e,t){let s=e.previousElementSibling;if(!t)return s;for(;s;){if(s.matches(t))return s;const l=s.querySelector(t);if(l)return l;s=s.previousElementSibling}return null}getNextSibling(e,t){let s=e.nextElementSibling;if(!t)return s;for(;s;){if(s.matches(t))return s;const l=s.querySelector(t);if(l)return l;s=s.nextElementSibling}return null}}return u.\u0275fac=function(e){return new(e||u)},u.\u0275prov=b.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();var F=r(452);let V=(()=>{class u{constructor(e,t,s){this.httpClient=e,this.htmlParser=t,this.settings=s}get proxy(){return O._[this.settings.proxy.name]}scrape(e,t,s,l){return this.getResponse(e).pipe((0,i.U)(p=>this.htmlParser.parse(p,t,s,l)))}getResponse(e){var t,s;if(!this.settings.proxy.enabled)return this.getRawHTML(e);const l="json"===(null===(t=this.proxy.options)||void 0===t?void 0:t.responseType)?this.getJSON(e):this.getRawHTML(e);return(null===(s=this.proxy.options)||void 0===s?void 0:s.responseParser)?l.pipe((0,i.U)(this.proxy.options.responseParser)):l}getRawHTML(e,t){return this.get(this.resolveUrl(e),{responseType:"text",headers:this.getRequestHeaders(),timeout:t})}getJSON(e,t){return this.get(this.resolveUrl(e),{responseType:"json",headers:this.getRequestHeaders(),timeout:t})}get(e,t){const{timeout:s=3e4}=t,l=(0,A._T)(t,["timeout"]);return this.httpClient.get(e,l).pipe(function E(u,K){const{first:e,each:t,with:s=n,scheduler:l=(null!=K?K:S.z),meta:p=null}=(0,C.q)(u)?{first:u}:"number"==typeof u?{each:u}:u;if(null==e&&null==t)throw new TypeError("No timeout provided.");return(0,L.e)((x,I)=>{let T,c,d=null,P=0;const v=y=>{c=(0,h.f)(I,l,()=>{try{T.unsubscribe(),(0,f.Xf)(s({meta:p,lastValue:d,seen:P})).subscribe(I)}catch(w){I.error(w)}},y)};T=x.subscribe((0,o.x)(I,y=>{null==c||c.unsubscribe(),P++,I.next(d=y),t>0&&v(t)},void 0,void 0,()=>{(null==c?void 0:c.closed)||null==c||c.unsubscribe(),d=null})),v(null!=e?"number"==typeof e?e:+e-l.now():t)})}(s),(0,a.K)(p=>{const x=this.resolveError(p,e);return console.error(x),(0,m.of)("json"===l.responseType?{}:"")}))}resolveError(e,t){return"Timeout has occurred"===e.message?`${e.message} for ${t}`:e.message}resolveUrl(e){var t,s,l;if(!this.settings.proxy.enabled)return e;const p=this.getRequestParams({url:e}),x=(0,R.nZ)(p,null===(l=null===(s=null===(t=this.proxy.options)||void 0===t?void 0:t.paramsEncoding)||void 0===s?void 0:s.enabled)||void 0===l||l);return`${this.proxy.url}${x||e}`}getRequestParams(e){const t=this.settings.proxy.enabled?this.proxy.params:null;return t?Object.keys(t).reduce((s,l)=>Object.assign(Object.assign({},s),{[l]:this.resolveValue(t[l],e)}),{}):{}}getRequestHeaders(){const e=this.settings.proxy.enabled?this.proxy.headers:null;return e?Object.keys(e).reduce((t,s)=>Object.assign(Object.assign({},t),{[s]:this.resolveValue(e[s])}),{}):{}}resolveValue(e,t){switch(e){case"$url":return(null==t?void 0:t.url)||e;case"$hostname":return window.location.hostname;case"$apiKey":return this.settings.proxy.apiKey;default:return e}}}return u.\u0275fac=function(e){return new(e||u)(b.LFG(_.eN),b.LFG(B),b.LFG(F.g))},u.\u0275prov=b.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},4128:(j,M,r)=>{r.d(M,{D:()=>o});var A=r(8306),m=r(4742),S=r(8421),C=r(3269),L=r(5403),f=r(3268),g=r(1810);function o(...h){const D=(0,C.jO)(h),{args:E,keys:n}=(0,m.D)(h),i=new A.y(a=>{const{length:O}=E;if(!O)return void a.complete();const R=new Array(O);let b=O,_=O;for(let U=0;U<O;U++){let W=!1;(0,S.Xf)(E[U]).subscribe((0,L.x)(a,B=>{W||(W=!0,_--),R[U]=B},()=>b--,void 0,()=>{(!b||!W)&&(_||a.next(n?(0,g.n)(n,R):R),a.complete())}))}});return D?i.pipe((0,f.Z)(D)):i}},2805:(j,M,r)=>{r.d(M,{H:()=>L});var A=r(8306),m=r(1566),S=r(3532),C=r(1165);function L(f=0,g,o=m.P){let h=-1;return null!=g&&((0,S.K)(g)?o=g:h=g),new A.y(D=>{let E=(0,C.q)(f)?+f-o.now():f;E<0&&(E=0);let n=0;return o.schedule(function(){D.closed||(D.next(n++),0<=h?this.schedule(void 0,h):D.complete())},E)})}},1566:(j,M,r)=>{r.d(M,{P:()=>D,z:()=>h});var A=r(727);class m extends A.w0{constructor(n,i){super()}schedule(n,i=0){return this}}const S={setInterval(...E){const{delegate:n}=S;return((null==n?void 0:n.setInterval)||setInterval)(...E)},clearInterval(E){const{delegate:n}=S;return((null==n?void 0:n.clearInterval)||clearInterval)(E)},delegate:void 0};var C=r(8737);const f={now:()=>(f.delegate||Date).now(),delegate:void 0};class g{constructor(n,i=g.now){this.schedulerActionCtor=n,this.now=i}schedule(n,i=0,a){return new this.schedulerActionCtor(this,n).schedule(a,i)}}g.now=f.now;const h=new class o extends g{constructor(n,i=g.now){super(n,i),this.actions=[],this._active=!1,this._scheduled=void 0}flush(n){const{actions:i}=this;if(this._active)return void i.push(n);let a;this._active=!0;do{if(a=n.execute(n.state,n.delay))break}while(n=i.shift());if(this._active=!1,a){for(;n=i.shift();)n.unsubscribe();throw a}}}(class L extends m{constructor(n,i){super(n,i),this.scheduler=n,this.work=i,this.pending=!1}schedule(n,i=0){if(this.closed)return this;this.state=n;const a=this.id,O=this.scheduler;return null!=a&&(this.id=this.recycleAsyncId(O,a,i)),this.pending=!0,this.delay=i,this.id=this.id||this.requestAsyncId(O,this.id,i),this}requestAsyncId(n,i,a=0){return S.setInterval(n.flush.bind(n,this),a)}recycleAsyncId(n,i,a=0){if(null!=a&&this.delay===a&&!1===this.pending)return i;S.clearInterval(i)}execute(n,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const a=this._execute(n,i);if(a)return a;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,i){let O,a=!1;try{this.work(n)}catch(R){a=!0,O=R||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),O}unsubscribe(){if(!this.closed){const{id:n,scheduler:i}=this,{actions:a}=i;this.work=this.state=this.scheduler=null,this.pending=!1,(0,C.P)(a,this),null!=n&&(this.id=this.recycleAsyncId(i,n,null)),this.delay=null,super.unsubscribe()}}}),D=h},1165:(j,M,r)=>{function A(m){return m instanceof Date&&!isNaN(m)}r.d(M,{q:()=>A})}}]);