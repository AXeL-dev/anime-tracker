!function(){function e(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw s}}}}function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=a(e);if(t){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}(self.webpackChunkanime_tracker=self.webpackChunkanime_tracker||[]).push([[592],{5360:function(e,t,n){"use strict";n.d(t,{k:function(){return r},E:function(){return i}});var r=(function(e){e.Success="success",e.Info="info",e.Error="error"}(r||(r={})),r),i=(function(e){e.Read="read",e.Unread="unread"}(i||(i={})),i)},961:function(n,r,s){"use strict";s.d(r,{_:function(){return S}});var a=s(6622),c=s(5427),l=s(4056),d=s(7574),v=s(1456),h=s(9796);function p(e){return!(0,h.k)(e)&&e-parseFloat(e)+1>=0}var g=s(4869);function y(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}var m=s(5758),b=s(8071),k=s(7393),w=function(){function e(t,n){u(this,e),this.predicate=t,this.inclusive=n}return f(e,[{key:"call",value:function(e,t){return t.subscribe(new x(e,this.predicate,this.inclusive))}}]),e}(),x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e,r,i){var o;return u(this,n),(o=t.call(this,e)).predicate=r,o.inclusive=i,o.index=0,o}return f(n,[{key:"_next",value:function(e){var t,n=this.destination;try{t=this.predicate(e,this.index++)}catch(r){return void n.error(r)}this.nextOrComplete(e,t)}},{key:"nextOrComplete",value:function(e,t){var n=this.destination;Boolean(t)?n.next(e):(this.inclusive&&n.next(e),n.complete())}}]),n}(k.L),E=s(8002),L=s(4612),D=s(3470),R=s(639),O=s(5923),A=s(452),F=s(3631),S=function(){var n=function(){function n(e,t,r){u(this,n),this.crawlers=e,this.settings=t,this.debug=r}return f(n,[{key:"search",value:function(e){var t=this.crawlers.getActive();return(0,m.D)(t.map(function(t){return t.searchAnime(e)})).pipe((0,E.U)(function(e){return(0,a.x)(e)}))}},{key:"getLatestEpisodes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.crawlers.getActive(t);return(0,m.D)(n.map(function(e){return e.getLatestEpisodes(t)})).pipe((0,E.U)(function(t){var n=(0,a.x)(t.map(function(t){return t.slice(0,Math.min(t.length,e.settings.maxEpisodesToRetrieve))}));return e.debug.log("All latest episodes:",n),e.debug.log("--------------------------"),e.mergeEpisodes(n)}))}},{key:"getLatestEpisodesByDays",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,i=this.crawlers.getActive(n),o=[],s=0;return r||(r=this.settings.maxEpisodesToRetrieve),b.z.apply(void 0,t(i.map(function(e){return e.getLatestEpisodes(n)}))).pipe((0,L.b)(function(t,n){var a=t.slice(0,Math.min(t.length,e.settings.maxEpisodesToRetrieve));e.debug.log("".concat(i[n].name," latest episodes:"),a),e.debug.log("--------------------------"),o=e.mergeEpisodes(a,o);var u=!0;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=-1;return p(t)?r=Number(t)<1?1:Number(t):(0,g.K)(t)&&(n=t),(0,g.K)(n)||(n=v.P),new d.y(function(t){var i=p(e)?e:+e-n.now();return n.schedule(y,i,{index:0,period:r,subscriber:t})})}(100,500).pipe(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){return n.lift(new w(e,t))}}(function(){return u}),(0,E.U)(function(t){var n=t*r+s+r;n>=o.length&&(n=o.length,s=n,u=!1);var i=o.slice(0,n),a=e.settings.displayEpisodesDayByDay?e.getEpisodesDays(i):[];return e.debug.log("Slice",t,":",i),e.debug.log("Days:",a),e.debug.log("----------------------------"),[i,a]}))}))}},{key:"mergeEpisodes",value:function(n){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return n.forEach(function(n){var o,s,a,u=0,c=e(i);try{for(c.s();!(a=c.n()).done;){var f=a.value;if((0,l.T0)(f.anime.title,n.anime.title,r.settings.episodeSimilarityDegree)&&f.number===n.number)return i[u].releaseDate&&!i[u].hasTemporaryReleaseDate||(i[u].releaseDate=n.releaseDate,i[u].hasTemporaryReleaseDate=!1),(null===(o=n.streamLinks)||void 0===o?void 0:o.length)&&(i[u].streamLinks=[].concat(t(i[u].streamLinks),t(n.streamLinks))),(null===(s=n.downloadLinks)||void 0===s?void 0:s.length)&&(i[u].downloadLinks=[].concat(t(i[u].downloadLinks),t(n.downloadLinks))),n.anime.isNew&&!i[u].anime.isNew&&(i[u].anime.isNew=n.anime.isNew),void(n.anime.isFinished&&!i[u].anime.isFinished&&(i[u].anime.isFinished=n.anime.isFinished));u++}}catch(d){c.e(d)}finally{c.f()}i.push(Object.assign(Object.assign({},n),{streamLinks:n.streamLinks||[],downloadLinks:n.downloadLinks||[]}))}),i.length&&(i=i.sort(function(e,t){return r.settings.sortEpisodesBy===c.q.FetchingDate&&(0,D.zu)(e.releaseDate,t.releaseDate)?e.fetchingDate-t.fetchingDate:t.releaseDate-e.releaseDate})),i}},{key:"getEpisodesDays",value:function(e){var t=[];return e.forEach(function(e){if(e.releaseDate){var n=(0,D.hp)(new Date(e.releaseDate));-1===t.indexOf(n)&&t.push(n)}}),t}}]),n}();return n.\u0275fac=function(e){return new(e||n)(R.LFG(O.K),R.LFG(A.g),R.LFG(F.r))},n.\u0275prov=R.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n}()},8604:function(e,t,n){"use strict";n.d(t,{S:function(){return s}});var r=n(4762),i=n(639),o=n(1188),s=function(){var e=function(){function e(t){u(this,e),this.storage=t,this.init()}return f(e,[{key:"init",value:function(){return(0,r.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.get("favorites");case 2:t=e.sent,this.favorites=(null==t?void 0:t.length)?t:[];case 4:case"end":return e.stop()}},e,this)}))}},{key:"save",value:function(){this.storage.save("favorites",this.favorites)}},{key:"get",value:function(){return this.favorites}},{key:"add",value:function(e){this.isFavorite(e)||(this.favorites.push(e),this.save())}},{key:"remove",value:function(e){var t=this.getIndexOf(e);-1!==t&&(this.favorites.splice(t,1),this.save())}},{key:"isFavorite",value:function(e){return-1!==this.getIndexOf(e)}},{key:"getIndexOf",value:function(e){var t;return null===(t=this.favorites)||void 0===t?void 0:t.indexOf(e)}},{key:"refresh",value:function(){return this.init()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.LFG(o.V))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},9744:function(e,n,r){"use strict";r.d(n,{T:function(){return d}});var i=r(4762),o=r(5360),s=r(3470),a=r(639),c=r(4071),l=r(5263),d=function(){var e=function(){function e(t,n){u(this,e),this.browser=t,this.router=n,this.notifications=[],this.canSendMessage=!1,this.canUpdateBackgroundNotifications=!0,this.canSendMessage=this.browser.isWebExtension&&"/background"!==this.router.url,this.canSendMessage&&this.fetchFromBackgroundScript(),this.listenToConsole()}return f(e,[{key:"fetchFromBackgroundScript",value:function(){return(0,i.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.browser.sendMessage("getNotifications");case 2:(null==(n=e.sent)?void 0:n.length)&&(this.notifications=t(n));case 4:case"end":return e.stop()}},e,this)}))}},{key:"listenToConsole",value:function(){var e=this,t=console.error;console.error=function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];e.push(n,o.k.Error),t.apply(void 0,[n].concat(i))}}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.k.Info;this.notifications.unshift({message:e,type:t,date:(0,s.zO)(),status:o.E.Unread})}},{key:"get",value:function(){return this.notifications}},{key:"markAllAsRead",value:function(){return this.canSendMessage&&this.canUpdateBackgroundNotifications&&(this.browser.sendMessage("markNotificationsAsRead"),this.canUpdateBackgroundNotifications=!1),this.notifications.forEach(function(e){e.status=o.E.Read}),this.notifications}},{key:"unreadCount",get:function(){return this.notifications.filter(function(e){return!e.status||e.status===o.E.Unread}).length}},{key:"hasUnread",value:function(){return this.unreadCount>0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.LFG(c.q),a.LFG(l.F0))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},1942:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var r=n(4762),i=n(4056),o=n(639),s=n(1188),a=n(452),c=n(4071),l=function(){var e=function(){function e(t,n,r){u(this,e),this.storage=t,this.settings=n,this.browser=r,this.init()}return f(e,[{key:"init",value:function(){return(0,r.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAsync(!0);case 2:this.viewed=e.sent,this.url=this.browser.getUrl("viewed");case 4:case"end":return e.stop()}},e,this)}))}},{key:"getAsync",value:function(e){var t;return(0,r.mG)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(null===(t=this.viewed)||void 0===t?void 0:t.length)||e){n.next=2;break}return n.abrupt("return",this.viewed);case 2:return n.next=4,this.storage.get("viewed");case 4:return r=n.sent,n.abrupt("return",(null==r?void 0:r.length)?r:[]);case 6:case"end":return n.stop()}},n,this)}))}},{key:"save",value:function(){this.storage.save("viewed",this.viewed)}},{key:"get",value:function(){return this.viewed}},{key:"add",value:function(e){this.isViewed(e)||(this.viewed.push({animeTitle:e.anime.title,number:e.number}),this.save())}},{key:"remove",value:function(e){var t,n,r=null===(t=this.viewed)||void 0===t?void 0:t.filter(function(t){return!((0,i.T0)(t.animeTitle,e.anime.title,.9,!0)&&t.number===e.number)});(null==r?void 0:r.length)<(null===(n=this.viewed)||void 0===n?void 0:n.length)&&(this.viewed=r,this.save())}},{key:"isViewed",value:function(e){var t;return!!(null===(t=this.viewed)||void 0===t?void 0:t.find(function(t){return(0,i.T0)(t.animeTitle,e.anime.title,.9,!0)&&t.number===e.number}))}},{key:"isRegular",value:function(e){var t,n=this;return!!(null===(t=this.viewed)||void 0===t?void 0:t.find(function(t){return(0,i.T0)(t.animeTitle,e.anime.title,n.settings.episodeSimilarityDegree)}))}},{key:"refresh",value:function(){return this.init()}},{key:"getEpisodeUrl",value:function(e){return"".concat(this.url,"/").concat(e.anime.title)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.LFG(s.V),o.LFG(a.g),o.LFG(c.q))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()}}])}();