<div #viewport class="snippet-page">
  <aside mdcDrawerContainer="temporary" [(open)]="open">
    <nav mdcDrawer>
      <div mdcDrawerToolbarSpacer></div>
      <!-- <div mdcDrawerHeader>
        <div mdcDrawerHeaderContent>Anime Tracker</div>
      </div> -->
      <div mdcDrawerContent mdcListGroup>
        <nav mdcList>
          <a mdcListItem href="javascript:void(0)" [selected]="isLatestView()" (click)="showLatest()">
            <i mdcListItemGraphic class="material-icons" aria-hidden="true">star</i>Latest
          </a>
          <a mdcListItem href="javascript:void(0)" [selected]="isFavoritesView()" (click)="showFavorites()">
            <i mdcListItemGraphic class="material-icons" aria-hidden="true">favorite</i>Favorites
          </a>
        </nav>
        <!-- <hr mdcListDivider> -->
      </div>
    </nav>
  </aside>
  <div class="content">
    <header mdcTopAppBar [viewport]="viewport" [fixedAdjust]="content">
      <div mdcTopAppBarRow>
        <section mdcTopAppBarSection alignStart>
          <button mdcTopAppBarNavIcon class="material-icons" (click)="toggleDrawer()">menu</button>
          <span mdcTopAppBarTitle>Anime Tracker</span>
          <app-search-input [(value)]="searchInputValue" (tap)="isSearching = true" (valueChange)="search($event)"></app-search-input>
        </section>
        <section mdcTopAppBarSection alignEnd>
          <a [routerLink]="['/settings']" mdcTopAppBarAction class="material-icons" label="Settings">settings</a>
        </section>
      </div>
      <div mdcLinearProgress [indeterminate]="true" [closed]="!isLoading && !isSearching"></div>
    </header>

    <main #content>

        <ng-container *ngIf="settings.displayEpisodesDayByDay; else showAllTemplate">

          <ng-container *ngFor="let day of days">
            <ng-container *ngIf="episodesByDays[day]?.length">
              <h3 class="day-title">{{ day | shortdate }}</h3>
              <div class="day-divider"></div>
              <section class="custom-card-container">
                <episode-card
                  *ngFor="let episode of episodesByDays[day]"
                  [episode]="episode"
                  (streamLinksClick)="openStreamLinksDialog($event)"
                  (downloadLinksClick)="openDownloadLinksDialog($event)"
                ></episode-card>
              </section>
            </ng-container>
          </ng-container>

        </ng-container>

        <ng-template #showAllTemplate>

          <section class="custom-card-container">
            <episode-card
              *ngFor="let episode of episodes"
              [episode]="episode"
              (streamLinksClick)="openStreamLinksDialog($event)"
              (downloadLinksClick)="openDownloadLinksDialog($event)"
            ></episode-card>
          </section>

        </ng-template>

        <episode-choose-link-dialog #streamLinksDialog
          [title]="'Choose a stream link'"
          [links]="selectedEpisode?.streamLinks || []"
          (linkClick)="markEpisodeAsViewed(selectedEpisode)"
          (close)="selectedEpisode = null"
        ></episode-choose-link-dialog>

        <episode-choose-link-dialog #downloadLinksDialog
          [title]="'Choose a download link'"
          [links]="selectedEpisode?.downloadLinks || []"
          (linkClick)="markEpisodeAsViewed(selectedEpisode)"
          (close)="selectedEpisode = null"
        ></episode-choose-link-dialog>

    </main>
  </div>
</div>
